<!-- <!DOCTYPE html>
<html>
<head>
  <title>Live Google Sheet Data</title>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
    }
    .box {
      padding: 15px;
      border: 1px solid #ccc;
      margin-top: 20px;
      width: fit-content;
    }
  </style>
</head>
<body>
  <h2>üü¢ Live Google Sheet Data</h2>
  <div class="box" id="dataBox">Loading...</div>

  <script>
    async function fetchData() {
      try {
        const res = await fetch('/data');
        if (!res.ok) throw new Error("Fetch failed");
        const data = await res.json();

        let html = "";
        for (let key in data) {
          html += `<b>${key}:</b> ${data[key]}<br>`;
        }

        document.getElementById('dataBox').innerHTML = html;
      } catch (err) {
        document.getElementById('dataBox').innerHTML = "‚ùå Error fetching data.";
        console.error(err);
      }
    }

    // Initial fetch
    fetchData();

    // Auto refresh every 5 seconds
    setInterval(fetchData, 5000);
  </script>
</body>
</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Google Sheet Cell Viewer & Editor</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    input, button { margin: 5px; padding: 8px; }
    #status { margin-top: 10px; color: green; }
  </style>
</head>
<body>
  <h2>üìÑ Google Sheet Cell Viewer & Editor</h2>

  <input id="cellInput" placeholder="Enter cell (e.g., A1)" />
  <br><br>

  <label>Cell Value:</label><br>
  <input id="cellValue" placeholder="Cell value will appear here..." />
  <br>
  <button onclick="updateCell()">Update</button>

  <p id="status"></p>

  <script>
    // üëá Auto-fetch when cellInput changes
    document.getElementById('cellInput').addEventListener('input', async function () {
      const cell = this.value.trim().toUpperCase();
      if (!cell) return;

      try {
        const res = await fetch(`/getCell?cell=${cell}`);
        const data = await res.json();
        document.getElementById('cellValue').value = data.value || '';
      } catch (err) {
        console.error('‚ùå Fetch error:', err);
        document.getElementById('cellValue').value = '';
      }
    });

    // ‚úÖ Update cell value
    async function updateCell() {
      const cell = document.getElementById('cellInput').value.trim().toUpperCase();
      const value = document.getElementById('cellValue').value;

      try {
        const res = await fetch('/updateCell', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ cell, value })
        });
        const data = await res.json();
        document.getElementById('status').innerText = data.message || '‚úÖ Updated!';
      } catch (err) {
        console.error('‚ùå Update error:', err);
        document.getElementById('status').innerText = '‚ùå Failed to update';
      }
    }
  </script>
</body>
</html>
